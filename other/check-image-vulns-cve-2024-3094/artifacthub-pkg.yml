name: check-image-vulns-cve-2024-3094
version: 1.0.0
displayName: Verify Image Check CVE-2024-3094
createdAt: "2023-04-10T20:30:03.000Z"
description: >-
  CVE-CVE-2024-3094 is a critical vulnerability in the XZ library. This policy checks attested SBOMs in an image in CycloneDX format and denies it if it contains versions 5.6-5.6.1 of the "liblzma & xz-utils" packages.
install: |-
  \```shell
  kubectl apply -f https://raw.githubusercontent.com/kyverno/policies/main/software-supply-chain-security/check-image-vulns-cve-2024-3094.yaml
  \```
keywords:
  - kyverno
  - Security
  - Software Supply Chain Security
readme: |
  CVE-CVE-2024-3094 is a critical vulnerability in the XZ library. Detecting the affected package may be done in an SBOM by identifying the "liblzma & xz-utils" package with one of the affected versions. This policy checks attested SBOMs in an image in CycloneDX format, specified under `imageReferences`, and denies it if it contains versions 5.6-5.6.1 of the packages. Using this for your purposes will require customizing the `imageReferences`, `subject`, and `issuer` fields based on your image signatures and attestations.
annotations:
  kyverno/category: "Software Supply Chain Security"
  kyverno/subject: "Pod"
digest: ce080b7e7ab9a00b56c16bca8c4833c8042e0863140d1ee3d27eab576ab35035
